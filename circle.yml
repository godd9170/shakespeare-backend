machine:
  python:
    version: 3.4.3
  services:
    - postgresql
general:
  build_dir: shakespeare
dependencies:
  pre:
    #- sudo apt-get install python-dev
    - sudo pip install --upgrade pip
    - sudo pip install appdirs --upgrade #appdir workaround https://github.com/ActiveState/appdirs/issues/89#issuecomment-282326570
    #- sudo pip install 'awsebcli==3.7.4' --force-reinstall
    - sudo pip install -r ../requirements.txt #reqs are a dir above
database:
  override:
    - echo "CREATE USER shakespeareadmin WITH PASSWORD 'salesforce1';" | psql -U postgres
    - echo "ALTER USER shakespeareadmin CREATEDB;" | psql -U postgres
deployment:
  production:
    branch: master
    commands:
      - eb deploy --profile default